name: Nightly build

on:
    schedule:
        - cron: "0 0 * * *" # Run at midnight UTC
    workflow_dispatch:

jobs:
    build-archetype:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - name: Set up Java SE 8
              uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: 8

            - name: Cache Maven packages
              uses: actions/cache@v4
              with:
                  path: ~/.m2
                  key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
                  restore-keys: ${{ runner.os }}-m2

            - name: Build Archetype
              run: mvn clean install --file archetype/pom.xml

            - name: Run Archetype for EE 8, SE 7
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=7 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="valid Java SE versions are 8, 11, 17, and 21"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 8, SE 8, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Ddocker=yes -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  WARN_MESSAGE="Docker support is not possible without choosing a runtime"
                  if ! { [ $MAVEN_EXIT_CODE -eq 0 ] && [ ! -f app/jakartaee-hello-world/Dockerfile ] && grep -q "$WARN_MESSAGE" mvn_output.txt;  }; then
                      echo "Maven build failed, a Dockerfile was found, or the expected warning was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt
                  rm -rf app

            - name: Run Archetype for EE 8 Web Profile, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 8 Core Profile, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=core -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="Core Profile is only supported for Jakarta EE 10 and above"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8 MicroProfile, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=microprofile -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="valid Jakarta EE profiles are core, web, and full"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 9, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9 Web Profile, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1 Web Profile, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10, SE 8
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=8 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="Java SE 8 is not supported in Jakarta EE versions 10 or later"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 8, SE 8, GlassFish with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=glassfish -Ddocker=yes -DoutputDirectory=app/glassfish -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  WARN_MESSAGE="GlassFish does not yet support Docker"
                  if ! { [ $MAVEN_EXIT_CODE -eq 0 ] && [ ! -f app/glassfish/jakartaee-hello-world/Dockerfile ] && grep -q "$WARN_MESSAGE" mvn_output.txt;  }; then
                      echo "Maven build failed, a Dockerfile was found, or the expected warning was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt
                  rm -rf app/glassfish

            - name: Run Archetype for EE 8 Web Profile, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9 Web Profile, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1 Web Profile, SE 8, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=8 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 8, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8 Web Profile, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9 Web Profile, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1 Web Profile, SE 8, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=8 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8, SE 8, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 8, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 9, SE 8, Payara
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=8 -Druntime=payara -DoutputDirectory=app/payara -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="Payara does not offer a stable release for Jakarta EE 9 or Jakarta EE 9.1"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 8, TomEE
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=tomee -DoutputDirectory=app/tomee -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="TomEE only supports the Web Profile"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8 Web Profile, SE 8, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 9.1 Web Profile, SE 8, TomEE
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=8 -Druntime=tomee -DoutputDirectory=app/tomee -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="TomEE 9 does not support Java SE 8"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 8, WebLogic
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=weblogic -DoutputDirectory=app/weblogic -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="valid runtime values are none, glassfish, open-liberty, payara, tomee, and wildfly"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

            - name: Run Archetype for EE 8, SE 8, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 8, SE 8, WildFly, with invalid Docker option
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=8 -Druntime=wildfly -Ddocker=Y -DoutputDirectory=app/wildfly -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="valid Docker options are yes and no"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8 Web Profile, SE 8, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=8 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 9, SE 8, WildFly
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=8 -Druntime=wildfly -DoutputDirectory=app/wildfly -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="WildFly does not offer a stable release for Jakarta EE 9 or Jakarta EE 9.1"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Set up Java SE 11
              uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: 11

            - name: Run Archetype for EE 8, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 8 Web Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9 Web Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1 Web Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Web Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Core Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 11 Core Profile, SE 11
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=11 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="EE 11 does not support Java SE 11"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"  | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="GlassFish 5 only supports Java SE 8"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 9, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9 Web Profile, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1 Web Profile, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10 Web Profile, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10 Core Profile, SE 11, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=11 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="GlassFish does not support the Core Profile"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8 Web Profile, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9 Web Profile, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1 Web Profile, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Web Profile, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Core Profile, SE 11, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=11 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8, SE 11, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=11 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 11, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=11 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10, SE 11, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=11 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Web Profile, SE 11, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Core Profile, SE 11, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=11 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 11, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=11 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 9 Web Profile, SE 11, TomEE
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=11 -Druntime=tomee -DoutputDirectory=app/tomee -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="TomEE is certified against Jakarta EE 9.1, but not Jakarta EE 9"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 9.1 Web Profile, SE 11, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=11 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 10 Web Profile, SE 11, TomEE
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -Druntime=tomee -DoutputDirectory=app/tomee -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="TomEE does not yet support Jakarta EE versions 10 or later"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 11, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=11 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 8 Web Profile, SE 11, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=11 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10, SE 11, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=11 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Web Profile, SE 11, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=11 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Core Profile, SE 11, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=11 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Set up Java SE 17
              uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: 17

            - name: Run Archetype for EE 8, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 8 Web Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9 Web Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1 Web Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Web Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Core Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 11, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=full -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="for Jakarta EE 11 please choose Core Profile and Open Liberty or none as runtime at the current time"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 11 Core Profile, SE 17
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=17 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9, SE 17, GlassFish
              run: |
                 mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                 rm -rf app/glassfish

            - name: Run Archetype for EE 9 Web Profile, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1 Web Profile, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10 Web Profile, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 11, SE 17, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=full -DjavaVersion=17 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="for Jakarta EE 11 please choose Core Profile and Open Liberty or none as runtime at the current time"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8 Web Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9 Web Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1 Web Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Web Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Core Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 11, SE 17, Open Liberty
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=full -DjavaVersion=17 -Druntime="open-liberty" -DoutputDirectory=app/open-liberty -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="for Jakarta EE 11 please choose Core Profile and Open Liberty or none as runtime at the current time"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 11 Core Profile, SE 17, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=17 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Web Profile, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Core Profile, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 11 Core Profile, SE 17, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=17 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="for Jakarta EE 11 please choose Core Profile and Open Liberty or none as runtime at the current time"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 8 Web Profile, SE 17, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=17 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 9.1 Web Profile, SE 17, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=17 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 8, SE 17, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=17 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 8 Web Profile, SE 17, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=17 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10, SE 17, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=17 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Web Profile, SE 17, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=17 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Core Profile, SE 17, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=17 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Set up Java SE 21
              uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: 21

            - name: Run Archetype for EE 8, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 8 Web Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9 Web Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 9.1 Web Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Web Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 10 Core Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 11 Core Profile, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package"
                  rm -rf app

            - name: Run Archetype for EE 12, SE 21
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=12 -Dprofile=full -DjavaVersion=21 -DoutputDirectory=app -Dgoals="clean package" | tee mvn_output.txt

                  MAVEN_EXIT_CODE=${PIPESTATUS[0]}
                  ERROR_MESSAGE="valid Jakarta EE versions are 8, 9, 9.1, 10, and 11"
                  if ! { [ $MAVEN_EXIT_CODE -ne 0 ] && grep -q "$ERROR_MESSAGE" mvn_output.txt; }; then
                      echo "Maven build did not fail, or the expected error message was not found. Test failed."
                      exit 1
                  fi

                  rm -f mvn_output.txt

            - name: Run Archetype for EE 9, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9 Web Profile, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 9.1 Web Profile, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 10 Web Profile, SE 21, GlassFish
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=21 -Druntime=glassfish -DoutputDirectory=app/glassfish -Dgoals="clean package"
                  rm -rf app/glassfish

            - name: Run Archetype for EE 8, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8 Web Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=full -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9 Web Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9 -Dprofile=web -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=full -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 9.1 Web Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Web Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 10 Core Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 11 Core Profile, SE 21, Open Liberty, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=11 -Dprofile=core -DjavaVersion=21 -Druntime="open-liberty" -Ddocker=yes -DoutputDirectory=app/open-liberty -Dgoals="clean package"
                  docker build -t test-image app/open-liberty/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/open-liberty

            - name: Run Archetype for EE 8, SE 21, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=21 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 21, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=21 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10, SE 21, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=21 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Web Profile, SE 21, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=21 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 10 Core Profile, SE 21, Payara, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=21 -Druntime=payara -Ddocker=yes -DoutputDirectory=app/payara -Dgoals="clean package"
                  docker build -t test-image app/payara/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/payara

            - name: Run Archetype for EE 8 Web Profile, SE 21, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=21 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 9.1 Web Profile, SE 21, TomEE, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=9.1 -Dprofile=web -DjavaVersion=21 -Druntime=tomee -Ddocker=yes -DoutputDirectory=app/tomee -Dgoals="clean package"
                  docker build -t test-image app/tomee/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/tomee

            - name: Run Archetype for EE 8, SE 21, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=full -DjavaVersion=21 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 8 Web Profile, SE 21, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=8 -Dprofile=web -DjavaVersion=21 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10, SE 21, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=full -DjavaVersion=21 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Web Profile, SE 21, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=web -DjavaVersion=21 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

            - name: Run Archetype for EE 10 Core Profile, SE 21, WildFly, with Docker
              run: |
                  mvn archetype:generate -DinteractiveMode=false -DaskForDefaultPropertyValues=false -DarchetypeGroupId=org.eclipse.starter -DarchetypeArtifactId=jakarta-starter -DarchetypeVersion=2.5.0-SNAPSHOT -DjakartaVersion=10 -Dprofile=core -DjavaVersion=21 -Druntime=wildfly -Ddocker=yes -DoutputDirectory=app/wildfly -Dgoals="clean package"
                  docker build -t test-image app/wildfly/jakartaee-hello-world
                  docker rmi test-image
                  rm -rf app/wildfly

    build-ui:
        runs-on: ubuntu-20.04
        steps:
            - uses: actions/checkout@v4
            - name: Setup Java
              uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: 17

            - name: Cache Maven packages
              uses: actions/cache@v4
              with:
                  path: ~/.m2
                  key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
                  restore-keys: ${{ runner.os }}-m2

            - name: Build UI
              run: mvn clean package --file ui/pom.xml
